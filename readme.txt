FakeSNI

Программа для обхода блокировок путем подмены значений SNI.


Предпосылки

В настоящее время большинство российских провайдеров перешло на использование 
фильтров DPI. В случае соединений по протоколу HTTPS почти весь обмен 
с удаленным сервером зашифрован. Для определения адресата фильтру остаются 
доступны два параметра соединения: IP-адрес и поле ServerName в запросе 
ClientHello. По ряду причин IP-адрес плохо подходит для реализации блокировок 
поэтому обычно проверяется ServerName как более надежный способ. Современные 
браузеры всегда добавляют SNI и, соответственно, открыто отправляют ServerName. 
Однако, протокол TLS 1.2 вполне допускает вообще не добавлять SNI в клиентский 
запрос. В этом случае сервер должен предполагать соединение с одним 
из обслуживаемых сайтов по умолчанию. Все проверенные автором провайдерские 
фильтры в настоящий момент пропускают запросы с отсутствующем SNI. Иногда 
возможно отправлять фальшивое значение для лучшей маскировки.


Реализация

К сожалению, невозможно убрать или заменить SNI путем изменения настроек 
браузеров даже с помощью расширений. Эта программа связывается с сайтом через 
соединения инициализированные ClientHello с фальшивым значением ServerName. 
Для того чтобы была возможность просматривать страницы программа локально 
запускает вебсервер ретранслирующий ответы. Таким образом, браузер может 
общаться с сайтом через адрес http://127.0.0.1:10000/


Установка

Установка программы не требуется. Скачайте архив соответствующий вашей ОС:

https://github.com/stopcenz/fakesni/releases/

Распакуйте и запустите файл fakesni. Для работы достаточно полномочий обычного 
пользователя. После запуска программа сама откроет новую вкладку с сайтом. Если 
этого не произошло попробуйте ввести в адресной строке вашего браузера адрес 
http://127.0.0.1:10000/


Параметры

-addr 127.0.0.1
  IP-адрес сетевого интерфейса который прослушивает программа. По соображениям 
  безопасности по умолчанию используется "127.0.0.1". Если вы хотите 
  предоставить доступ другим компьютерам можно установить значение "0.0.0.0" 
  тогда программа будет отвечать на всех доступных интерфейсах. Это может быть 
  полезно для работы с мобильных устройств через стационарный компьютер.
  
-port 10000
  Номер сетевого порта который прослушивает программа для связи с браузером.
  
-host rutracker.org
  Доменное имя сайта к которому выполняется доступ. Допустимо указывать 
  несколько таких ключей:
  
  fakesni.exe -host rutracker.org -host static.t-ru.org

-sni vk.com
  Строка отсылаемая в поле SNI/ServerName. Подойдет имя любого популярного сайта 
  или пустая строка. Можно проверить блокировку указав реальное доменное имя.

-tls13
  Разрешить TLS 1.3.
  
-ignorecert
  Пропускать проверку принятого сертификата.
  
-nobrowser
  Не открывать браузер.


Лицензия

Эта работа публикуется под лицензией СС0. Вы можете использовать программу 
без каких-либо ограничений.
